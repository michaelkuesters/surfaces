export function processElement(e,m,o={}){const{removeAttribute:r=!1,preserveExisting:p=!0}=o;const a=e.getAttribute('data-surface');if(!a)return;const t=a.trim().split(/\s+/).filter(Boolean),n=new Set;for(const s of t){const i=m[s];if(i)i.split(/\s+/).forEach(c=>{if(c)n.add(c)});else console.warn(`[Surfaces Mapper] Unknown mapping: "${s}"`)}const d=p?(e.className||'').split(/\s+/).filter(Boolean):[];e.className=[...d,...n].join(' ');r&&e.removeAttribute('data-surface')}export function processAll(m,o={}){const{removeAttribute:r=!1,preserveExisting:p=!0,root:e=document}=o;const a=e.querySelectorAll('[data-surface]'),t=[];return a.forEach(e=>{processElement(e,m,{removeAttribute:r,preserveExisting:p});t.push(e)}),t}export function init(m,o={}){if(!m)throw new Error('Surfaces Mapper: mappings parameter is required');const{autoProcess:a=!0,removeAttribute:r=!1,preserveExisting:p=!0}=o;processAll(m,{removeAttribute:r,preserveExisting:p});if(a&&typeof MutationObserver!=='undefined'){const e=new MutationObserver(t=>{t.forEach(n=>{n.addedNodes.forEach(s=>{if(s.nodeType===Node.ELEMENT_NODE){s.hasAttribute&&s.hasAttribute('data-surface')&&processElement(s,m,{removeAttribute:r,preserveExisting:p});const i=s.querySelectorAll&&s.querySelectorAll('[data-surface]');i&&i.forEach(e=>{processElement(e,m,{removeAttribute:r,preserveExisting:p})})}})})});return e.observe(document.body,{childList:!0,subtree:!0}),()=>e.disconnect()}}
